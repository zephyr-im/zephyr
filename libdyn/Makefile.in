SHELL = /bin/sh

prefix=@prefix@
exec_prefix=@exec_prefix@
datadir=@datadir@
sysconfdir=@sysconfdir@
sbindir=@sbindir@
lsbindir=@lsbindir@

includedir=${prefix}/include
mandir=@mandir@
libdir=${exec_prefix}/lib

srcdir=@srcdir@
top_srcdir=@top_srcdir@
top_builddir=..
BUILDTOP=..
VPATH=@srcdir@
CC=@CC@
LIBTOOL=@LIBTOOL@

CPPFLAGS=@CPPFLAGS@
CFLAGS=@CFLAGS@
ALL_CFLAGS=${CFLAGS} -I${top_srcdir}/h -I${BUILDTOP}/h ${CPPFLAGS}

OBJS =	dyn_append.lo dyn_create.lo dyn_debug.lo dyn_delete.lo dyn_insert.lo \
	dyn_paranoid.lo dyn_put.lo dyn_realloc.lo dyn_size.lo

all: libzdyn.la dyntest

libzdyn.la: ${OBJS}
	${LIBTOOL} ${CC} -all-static -version-info 1:0:0 -o libzdyn.la ${OBJS} -rpath $(libdir)

dyntest: dyntest.lo libzdyn.la 
	${LIBTOOL} ${CC} ${LDFLAGS} -o $@ dyntest.lo libzdyn.la

check:

install:

clean:
	${LIBTOOL} rm -f ${OBJS} libzdyn.la dyntest.lo dyntest

${OBJS} dyntest.lo: dynP.h ${top_srcdir}/h/dyn.h ${top_srcdir}/h/sysdep.h
${OBJS} dyntest.lo: ${BUILDTOP}/h/config.h

.PHONY: all check install clean
.SUFFIXES: .lo

.c.lo:
	${LIBTOOL} ${CC} -c ${ALL_CFLAGS} $<
