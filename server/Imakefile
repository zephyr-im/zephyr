/**/#	Copyright 1988 Massachusetts Institute of Technology.
/**/#
/**/#	For copying and distribution information, see the file
/**/#	"mit-copyright.h". 
/**/#
/**/#	$Source$
/**/#	$Author$
/**/#	$Header$
/**/#

#if defined(DO_SYSLOG) && defined(SYSLOG_COMPAT42)
SYSLOG_LIB= ../clients/syslogd/syslog.o
#else
SYSLOG_LIB=
#endif
LIBS= ${SYSLOG_LIB} ${ZEPHYR_LIB} ${HES_LIB} ${KRB_LIB} \
	${DES_LIB} ${COMERR_LIB}
LINTLIBS= ${ZEPHYR_LINTLIB} ${COMERR_LINTLIB} ${HES_LINTLIB} \
	${KRB_LINTLIB} ${DES_LINTLIB}

HDRS=	zserver.h \
	zsrv_conf.h \
	timer.h \
	ZString.h ZStringTable.h ZStringRep.h \
	Set.hT Set.CT \
	unix.h \
	zalloc.h \
	access.h \
	template_macros.h \
	new.h

SRCS=	main.C \
	access.C \
	bdump.C \
	class.C \
	client.C \
	common.C \
	dispatch.C \
	hostm.C \
	server.C \
	subscr.C \
	timer.C \
	uloc.C \
	kstuff.C \
	version.C \
	ZString.C ZStringTable.C \
	kopt.c \
	acl_files.c \
	xxx.c \
	zalloc.C

OBJS=	main.o \
	zsrv_err.o \
	access.o \
	bdump.o \
	class.o \
	client.o \
	common.o \
	dispatch.o \
	hostm.o \
	server.o \
	subscr.o \
	timer.o \
	uloc.o \
	kstuff.o \
	version.o \
	ZString.o ZStringTable.o \
	kopt.o \
	acl_files.o \
	xxx.o \
	zalloc.o

OTHERSRCS= zsrv_err.et
CONFIG_FILES= default.subscriptions
SRCDIR= ${SRCTOP}/server
CODE= ${SRCS} ${HDRS} ${OTHERSRCS} ${CONFIG_FILES} Imakefile

DEFINES=-DNDEBUG -DCONCURRENT
normal_obj_rule()

cplusplus_program(zephyrd,${OBJS},,${LIBS},${USRETCDIR})

error_table_noprof(zsrv_err)

src:: zsrv_err.h

depend:: zsrv_err.h

install::
	-mkdir ${DESTDIR}${ACLDIR}
	-rm -f ${DESTDIR}${ACLDIR}/?*.acl
	cp acldir/?* ${DESTDIR}${ACLDIR}
	${INSTALLFILE} default.subscriptions ${DESTDIR}${ACLDIR}/default.subscriptions
